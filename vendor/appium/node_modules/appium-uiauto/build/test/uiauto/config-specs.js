require('source-map-support').install();

'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _base = require('./base');

var _path = require('path');

var _path2 = _interopRequireDefault(_path);

var _appiumSupport = require('appium-support');

describe('config', function () {
  describe('custom socket', function () {
    var _this = this;

    var altSockDir = '/tmp/abcd';
    var altSock = _path2['default'].resolve(altSockDir, 'sock');
    var ctx = undefined;
    (0, _base.globalInit)(this, { chai: true, sock: altSock });
    before(function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(_appiumSupport.fs.rimraf(altSockDir));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap((0, _base.instrumentsInstanceInit)({ sock: altSock }));

          case 4:
            ctx = context$3$0.sent;

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
    after(function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap((0, _base.killAll)(ctx));

          case 2:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should use the alternate sock', function () {
      ctx.proxy.should.exist;
      ctx.proxy.sock.should.equal(altSock);
    });

    it('should work', function callee$2$0() {
      var res;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(ctx.execFunc(function () {
              return 'OK Boss';
            }));

          case 2:
            res = context$3$0.sent;

            res.should.equal('OK Boss');

          case 4:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvdWlhdXRvL2NvbmZpZy1zcGVjcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7OztvQkFFNkQsUUFBUTs7b0JBQ3JELE1BQU07Ozs7NkJBQ0gsZ0JBQWdCOztBQUduQyxRQUFRLENBQUMsUUFBUSxFQUFFLFlBQVk7QUFDN0IsVUFBUSxDQUFDLGVBQWUsRUFBRSxZQUFZOzs7QUFDcEMsUUFBSSxVQUFVLEdBQUcsV0FBVyxDQUFDO0FBQzdCLFFBQUksT0FBTyxHQUFHLGtCQUFLLE9BQU8sQ0FBQyxVQUFVLEVBQUUsTUFBTSxDQUFDLENBQUM7QUFDL0MsUUFBSSxHQUFHLFlBQUEsQ0FBQztBQUNSLDBCQUFXLElBQUksRUFBRSxFQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBQyxDQUFDLENBQUM7QUFDOUMsVUFBTSxDQUFDOzs7Ozs2Q0FDQyxrQkFBRyxNQUFNLENBQUMsVUFBVSxDQUFDOzs7OzZDQUNmLG1DQUF3QixFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsQ0FBQzs7O0FBQXRELGVBQUc7Ozs7Ozs7S0FDSixDQUFDLENBQUM7QUFDSCxTQUFLLENBQUM7Ozs7OzZDQUNFLG1CQUFRLEdBQUcsQ0FBQzs7Ozs7OztLQUNuQixDQUFDLENBQUM7O0FBRUgsTUFBRSxDQUFDLCtCQUErQixFQUFFLFlBQVk7QUFDOUMsU0FBRyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDO0FBQ3ZCLFNBQUcsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7S0FDdEMsQ0FBQyxDQUFDOztBQUVILE1BQUUsQ0FBQyxhQUFhLEVBQUU7VUFDWixHQUFHOzs7Ozs2Q0FBUyxHQUFHLENBQUMsUUFBUSxDQUMxQixZQUFZO0FBQ1YscUJBQU8sU0FBUyxDQUFDO2FBQ2xCLENBQ0Y7OztBQUpHLGVBQUc7O0FBS1AsZUFBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUM7Ozs7Ozs7S0FDN0IsQ0FBQyxDQUFDO0dBRUosQ0FBQyxDQUFDO0NBRUosQ0FBQyxDQUFDIiwiZmlsZSI6InRlc3QvdWlhdXRvL2NvbmZpZy1zcGVjcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIHRyYW5zcGlsZTptb2NoYVxuXG5pbXBvcnQgeyBpbnN0cnVtZW50c0luc3RhbmNlSW5pdCwgZ2xvYmFsSW5pdCwga2lsbEFsbCB9IGZyb20gJy4vYmFzZSc7XG5pbXBvcnQgcGF0aCBmcm9tJ3BhdGgnO1xuaW1wb3J0IHsgZnMgfSBmcm9tICdhcHBpdW0tc3VwcG9ydCc7XG5cblxuZGVzY3JpYmUoJ2NvbmZpZycsIGZ1bmN0aW9uICgpIHtcbiAgZGVzY3JpYmUoJ2N1c3RvbSBzb2NrZXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IGFsdFNvY2tEaXIgPSAnL3RtcC9hYmNkJztcbiAgICBsZXQgYWx0U29jayA9IHBhdGgucmVzb2x2ZShhbHRTb2NrRGlyLCAnc29jaycpO1xuICAgIGxldCBjdHg7XG4gICAgZ2xvYmFsSW5pdCh0aGlzLCB7Y2hhaTogdHJ1ZSwgc29jazogYWx0U29ja30pO1xuICAgIGJlZm9yZShhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBhd2FpdCBmcy5yaW1yYWYoYWx0U29ja0Rpcik7XG4gICAgICBjdHggPSBhd2FpdCBpbnN0cnVtZW50c0luc3RhbmNlSW5pdCh7IHNvY2s6IGFsdFNvY2sgfSk7XG4gICAgfSk7XG4gICAgYWZ0ZXIoYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQga2lsbEFsbChjdHgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB1c2UgdGhlIGFsdGVybmF0ZSBzb2NrJywgZnVuY3Rpb24gKCkge1xuICAgICAgY3R4LnByb3h5LnNob3VsZC5leGlzdDtcbiAgICAgIGN0eC5wcm94eS5zb2NrLnNob3VsZC5lcXVhbChhbHRTb2NrKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgd29yaycsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCByZXMgPSBhd2FpdCBjdHguZXhlY0Z1bmMoXG4gICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gJ09LIEJvc3MnO1xuICAgICAgICB9XG4gICAgICApO1xuICAgICAgcmVzLnNob3VsZC5lcXVhbCgnT0sgQm9zcycpO1xuICAgIH0pO1xuXG4gIH0pO1xuXG59KTtcbiJdLCJzb3VyY2VSb290IjoiLi4vLi4vLi4ifQ==
